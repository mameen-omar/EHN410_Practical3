<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EHN 410 - Group 7: rsa.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EHN 410 - Group 7
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">RSA and RC4 Encryption/Decryption/Key-Generation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">rsa.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>RSA library function prototype file. This file contains the necessary functionality to perform RSA key generation as well as encryption/decryption. The functions in this file consist of RSA key generation, RSA encryption, RSA decryption, Getting prime numbers and writing the keys to a file.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="random_number_generator_8h_source.html">randomNumberGenerator.h</a>&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for rsa.h:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h__incl.png" border="0" usemap="#rsa_8h" alt=""/></div>
<map name="rsa_8h" id="rsa_8h">
<area shape="rect" id="node2" href="random_number_generator_8h.html" title="Random number generator function prototype file. This file is used to generate random numbers to be u..." alt="" coords="251,80,429,107"/>
<area shape="rect" id="node3" href="rc4_lib_8h.html" title="RC4 library function prototype file. This file is used to perform encryption/decryption using the rc4..." alt="" coords="306,155,374,181"/>
<area shape="rect" id="node12" href="text_converter_8h.html" title="The text converter libary function prototype file. This file contains functions used to convert betwe..." alt="" coords="191,229,303,256"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h__dep__incl.png" border="0" usemap="#rsa_8hdep" alt=""/></div>
<map name="rsa_8hdep" id="rsa_8hdep">
<area shape="rect" id="node2" href="rsa_8c.html" title="RSA library implementation file. This file contains the necessary functionality to perform RSA key ge..." alt="" coords="5,80,56,107"/>
<area shape="rect" id="node3" href="rsadecrypt_8h.html" title="rsadecrypt.h" alt="" coords="81,80,175,107"/>
<area shape="rect" id="node5" href="rsaencrypt_8h.html" title="rsaencrypt.h" alt="" coords="199,80,294,107"/>
<area shape="rect" id="node7" href="rsakeygen_8h.html" title="rsakeygen.h" alt="" coords="319,80,412,107"/>
<area shape="rect" id="node9" href="rsa_tester_8c.html" title="rsaTester.c" alt="" coords="436,80,524,107"/>
<area shape="rect" id="node4" href="rsadecrypt_8c.html" title="rsadecrypt.c" alt="" coords="81,155,175,181"/>
<area shape="rect" id="node6" href="rsaencrypt_8c.html" title="rsaencrypt.c" alt="" coords="199,155,294,181"/>
<area shape="rect" id="node8" href="rsakeygen_8c.html" title="rsakeygen.c" alt="" coords="319,155,412,181"/>
</map>
</div>
</div>
<p><a href="rsa_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrsactx__t.html">rsactx_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a41e602bedc2bfcd50c6e35bfb6279ab5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#a41e602bedc2bfcd50c6e35bfb6279ab5">rsaInit</a> (<a class="el" href="structrsactx__t.html">rsactx_t</a> *rsaCtx)</td></tr>
<tr class="memdesc:a41e602bedc2bfcd50c6e35bfb6279ab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">rsaInit - Function used to initialize the RSA context state structure passed in as  <a href="#a41e602bedc2bfcd50c6e35bfb6279ab5">More...</a><br /></td></tr>
<tr class="separator:a41e602bedc2bfcd50c6e35bfb6279ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b449824145177f99b25444768d5d3d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrsactx__t.html">rsactx_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#a32b449824145177f99b25444768d5d3d">constructRSAContext</a> (unsigned char *initKey, uint8_t initKeyLength, int isKeyHex, int numBits)</td></tr>
<tr class="memdesc:a32b449824145177f99b25444768d5d3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructRSAContext - Function used to construct the RSA context structure used for RSA key-pair generation. The function allocates all memory required. In addition, the function initializes the random number generator (RC4 key stream) using the key passed in as  <a href="#a32b449824145177f99b25444768d5d3d">More...</a><br /></td></tr>
<tr class="separator:a32b449824145177f99b25444768d5d3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00fa4aa44618d82f5ef6ec9523cbc165"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#a00fa4aa44618d82f5ef6ec9523cbc165">rsaWriteKeysToFile</a> (<a class="el" href="structrsactx__t.html">rsactx_t</a> *rsaCtx, unsigned char *publicKeyFileName, unsigned char *privateKeyFileName)</td></tr>
<tr class="memdesc:a00fa4aa44618d82f5ef6ec9523cbc165"><td class="mdescLeft">&#160;</td><td class="mdescRight">rsaWriteKeysToFile - Function used to write the public and private keys store in the RSA Context passed in as  <a href="#a00fa4aa44618d82f5ef6ec9523cbc165">More...</a><br /></td></tr>
<tr class="separator:a00fa4aa44618d82f5ef6ec9523cbc165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2eb184f89ce2e058ce11f75d2babdd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#ac2eb184f89ce2e058ce11f75d2babdd4">generateRsaKeys</a> (<a class="el" href="structrsactx__t.html">rsactx_t</a> *rsaCtx)</td></tr>
<tr class="memdesc:ac2eb184f89ce2e058ce11f75d2babdd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">generateRsaKeys - Function used to generate the RSA public and private key-pair according to the specifications within the RSA state passed in as  <a href="#ac2eb184f89ce2e058ce11f75d2babdd4">More...</a><br /></td></tr>
<tr class="separator:ac2eb184f89ce2e058ce11f75d2babdd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94acde740fd5f6523c71d9310074e1ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#a94acde740fd5f6523c71d9310074e1ca">rsaEncrypt</a> (unsigned char *outputFile, unsigned char *publicKeyFile, unsigned char *plainText, size_t isPlaintextHex)</td></tr>
<tr class="memdesc:a94acde740fd5f6523c71d9310074e1ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">rsaEncrypt - Function used to encrypt the plaintext passed in as  <a href="#a94acde740fd5f6523c71d9310074e1ca">More...</a><br /></td></tr>
<tr class="separator:a94acde740fd5f6523c71d9310074e1ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7195163cfaccb994f5b3f28655d6e280"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#a7195163cfaccb994f5b3f28655d6e280">rsaDecrypt</a> (unsigned char *outputFile, unsigned char *privateKeyFile, unsigned char *cipherText)</td></tr>
<tr class="memdesc:a7195163cfaccb994f5b3f28655d6e280"><td class="mdescLeft">&#160;</td><td class="mdescRight">rsaDecrypt - Function used to decrypt the ciphertext passed in as  <a href="#a7195163cfaccb994f5b3f28655d6e280">More...</a><br /></td></tr>
<tr class="separator:a7195163cfaccb994f5b3f28655d6e280"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed0dce0633aa439d9479beab9822c6b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#aed0dce0633aa439d9479beab9822c6b8">getPrime</a> (mpz_t p, int bits)</td></tr>
<tr class="memdesc:aed0dce0633aa439d9479beab9822c6b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">getPrime - Function used to generate a prime number of length  <a href="#aed0dce0633aa439d9479beab9822c6b8">More...</a><br /></td></tr>
<tr class="separator:aed0dce0633aa439d9479beab9822c6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89855ab18349364b596e545d789ba03d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rsa_8h.html#a89855ab18349364b596e545d789ba03d">rsaClean</a> (<a class="el" href="structrsactx__t.html">rsactx_t</a> *rsaCtx)</td></tr>
<tr class="memdesc:a89855ab18349364b596e545d789ba03d"><td class="mdescLeft">&#160;</td><td class="mdescRight">rsaClean - Function used to deallocate all memory allocated for the RSA context state structure in  <a href="#a89855ab18349364b596e545d789ba03d">More...</a><br /></td></tr>
<tr class="separator:a89855ab18349364b596e545d789ba03d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>RSA library function prototype file. This file contains the necessary functionality to perform RSA key generation as well as encryption/decryption. The functions in this file consist of RSA key generation, RSA encryption, RSA decryption, Getting prime numbers and writing the keys to a file. </p>
<dl class="section author"><dt>Authors</dt><dd>Mohamed Ameen Omar (u16055323) </dd>
<dd>
Douglas Healy (u16018100) </dd>
<dd>
Llewellyn Moyse (u15100708) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019-05-22</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2019 </dd></dl>

<p class="definition">Definition in file <a class="el" href="rsa_8h_source.html">rsa.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a32b449824145177f99b25444768d5d3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32b449824145177f99b25444768d5d3d">&#9670;&nbsp;</a></span>constructRSAContext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrsactx__t.html">rsactx_t</a>* constructRSAContext </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>initKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>initKeyLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isKeyHex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numBits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>constructRSAContext - Function used to construct the RSA context structure used for RSA key-pair generation. The function allocates all memory required. In addition, the function initializes the random number generator (RC4 key stream) using the key passed in as </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initKey,used</td><td>for the generation of the RSA key-pairs. The function calls rsaInit function to aid in initialization. The caller must use cleanRSA in order to deallocate all memory once the key-pair has been generated.</td></tr>
    <tr><td class="paramname">unsigned</td><td>char* - initKey - The key used to initialize the random number generator. </td></tr>
    <tr><td class="paramname">initKeyLength</td><td>- uint8_t - The length of the key passed in as </td></tr>
    <tr><td class="paramname">initKey.</td><td></td></tr>
    <tr><td class="paramname">isKeyHex</td><td>- int - a flag indicating whether the key </td></tr>
    <tr><td class="paramname">initKey</td><td>is a hex string or ascii encoded string. </td></tr>
    <tr><td class="paramname">numBits</td><td>- int - the number of bits required for the public and private RSA key pair to be generated. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>rsactx_t* - A pointer to the RSA context structure used to store the state of the RSA key generation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00035">35</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a32b449824145177f99b25444768d5d3d_cgraph.png" border="0" usemap="#rsa_8h_a32b449824145177f99b25444768d5d3d_cgraph" alt=""/></div>
<map name="rsa_8h_a32b449824145177f99b25444768d5d3d_cgraph" id="rsa_8h_a32b449824145177f99b25444768d5d3d_cgraph">
<area shape="rect" id="node2" href="random_number_generator_8c.html#ab5420f1783a3b4d2801c80232daaac65" title="rseed &#45; Function used to create a random number generator object and set the seed for the random numb..." alt="" coords="206,56,261,83"/>
<area shape="rect" id="node12" href="rsa_8c.html#a41e602bedc2bfcd50c6e35bfb6279ab5" title="rsaInit &#45; Function used to initialize the RSA context state structure passed in as ..." alt="" coords="204,107,263,133"/>
<area shape="rect" id="node3" href="random_number_generator_8c.html#af6cd3a9729eb08f182d0b2df8bd8c7d8" title="destroyRNG &#45; Function used to deallocate all memory allocated for the random number generator..." alt="" coords="337,5,431,32"/>
<area shape="rect" id="node5" href="rc4_lib_8c.html#a2d3a139e4437494b462422ff2355b409" title="constructRc4Context &#45; Function to construct the RC4 context structure and construct the state vector ..." alt="" coords="311,56,457,83"/>
<area shape="rect" id="node6" href="rc4_lib_8c.html#adf2f7c39612e593f25961008b04cb22f" title="rc4Init &#45; Function used to initialize the state of the RC4 context and the state vector used for the ..." alt="" coords="355,107,413,133"/>
<area shape="rect" id="node4" href="rc4_lib_8c.html#aaead699517d29af2819f4dd9ea36cd2d" title="destroyRc4Context &#45; Function used to deallocate all memory allocated for the rc4 context structure pa..." alt="" coords="507,5,642,32"/>
<area shape="rect" id="node7" href="text_converter_8c.html#afba897e91364663f883cc51ed309dc92" title="keyHexToAscii &#45; Function to convert a hex encoded key to an ascii string. The caller must ensure they..." alt="" coords="519,81,630,108"/>
<area shape="rect" id="node11" href="rc4_lib_8c.html#abb929ea4bb5c1b41eaa7f3d067700c38" title="swapStateElements &#45; Function to swap the contents of the uint8_t pointers passed in as parameters ..." alt="" coords="505,132,644,159"/>
<area shape="rect" id="node8" href="text_converter_8c.html#ad697cbb5d9e462b3017df1f1d939ee96" title="hexToAsciiString &#45; Function that converts a given string of hex values into its ASCII equivalent..." alt="" coords="692,81,813,108"/>
<area shape="rect" id="node9" href="text_converter_8c.html#aa177516503b10de65b504a3714073ad7" title="hexToAscii &#45; Function that converts a given hex value to its ASCII equivalent. " alt="" coords="861,81,948,108"/>
<area shape="rect" id="node10" href="text_converter_8c.html#a7e5ab2188af44718071074f450963568" title="hexToInt &#45; Function that converts a given hex value into an integer. " alt="" coords="996,81,1069,108"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a32b449824145177f99b25444768d5d3d_icgraph.png" border="0" usemap="#rsa_8h_a32b449824145177f99b25444768d5d3d_icgraph" alt=""/></div>
<map name="rsa_8h_a32b449824145177f99b25444768d5d3d_icgraph" id="rsa_8h_a32b449824145177f99b25444768d5d3d_icgraph">
<area shape="rect" id="node2" href="rsakeygen_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="204,5,255,32"/>
</map>
</div>

</div>
</div>
<a id="ac2eb184f89ce2e058ce11f75d2babdd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2eb184f89ce2e058ce11f75d2babdd4">&#9670;&nbsp;</a></span>generateRsaKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generateRsaKeys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrsactx__t.html">rsactx_t</a> *&#160;</td>
          <td class="paramname"><em>rsaCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generateRsaKeys - Function used to generate the RSA public and private key-pair according to the specifications within the RSA state passed in as </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rsaCtx.</td><td>Makes use of the mpz libraries in order to compute the prime numbers used for the p and q variables used during RSA key generation. The function does check for negative values for the "d" parameter as a result of under and overflows and makes the required adjustments. Stores the RSA key pair and the parameters used during RSA key generation in the RSA state structure.</td></tr>
    <tr><td class="paramname">rsaCtx</td><td>- rsactx_t* - The RSA context state to use for the RSA key-pair generation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00077">77</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_cgraph.png" border="0" usemap="#rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_cgraph" alt=""/></div>
<map name="rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_cgraph" id="rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_cgraph">
<area shape="rect" id="node2" href="rsa_8c.html#aed0dce0633aa439d9479beab9822c6b8" title="getPrime &#45; Function used to generate a prime number of length " alt="" coords="180,5,255,32"/>
<area shape="rect" id="node3" href="random_number_generator_8c.html#a23a480165b4fdecf428a20ab7fbf3bcc" title="rrand &#45; Function used to generate a random number of a single byte long. " alt="" coords="303,5,353,32"/>
<area shape="rect" id="node4" href="rc4_lib_8c.html#a13e5254ff57f1390856238cb4c4d71bb" title="rc4GetByte &#45; Function used to generate a single byte of the RC4 key stream for the RC4 context passed..." alt="" coords="401,5,489,32"/>
<area shape="rect" id="node5" href="rc4_lib_8c.html#abb929ea4bb5c1b41eaa7f3d067700c38" title="swapStateElements &#45; Function to swap the contents of the uint8_t pointers passed in as parameters ..." alt="" coords="537,5,676,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_icgraph.png" border="0" usemap="#rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_icgraph" alt=""/></div>
<map name="rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_icgraph" id="rsa_8h_ac2eb184f89ce2e058ce11f75d2babdd4_icgraph">
<area shape="rect" id="node2" href="rsakeygen_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="180,5,231,32"/>
</map>
</div>

</div>
</div>
<a id="aed0dce0633aa439d9479beab9822c6b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed0dce0633aa439d9479beab9822c6b8">&#9670;&nbsp;</a></span>getPrime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getPrime </td>
          <td>(</td>
          <td class="paramtype">mpz_t&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>getPrime - Function used to generate a prime number of length </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bits</td><td>and store it in </td></tr>
    <tr><td class="paramname">p.</td><td>Used for RSA key-pair generation. </td></tr>
    <tr><td class="paramname">bits</td><td>should be half the length of the total length of the key required for the RSA keys. The function generates </td></tr>
    <tr><td class="paramname">bits</td><td>- 1 random numbers using the RC4 random key stream generator and uses the LSB of each random number generated as a bit in the in the final prime number. Once the random number of bits length is generated, the mpz_nextprime is used to get the closest prime number to the random number generated and store it in </td></tr>
    <tr><td class="paramname">p.</td><td></td></tr>
    <tr><td class="paramname">p</td><td></td></tr>
    <tr><td class="paramname">bits</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00133">133</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_aed0dce0633aa439d9479beab9822c6b8_cgraph.png" border="0" usemap="#rsa_8h_aed0dce0633aa439d9479beab9822c6b8_cgraph" alt=""/></div>
<map name="rsa_8h_aed0dce0633aa439d9479beab9822c6b8_cgraph" id="rsa_8h_aed0dce0633aa439d9479beab9822c6b8_cgraph">
<area shape="rect" id="node2" href="random_number_generator_8c.html#a23a480165b4fdecf428a20ab7fbf3bcc" title="rrand &#45; Function used to generate a random number of a single byte long. " alt="" coords="128,5,179,32"/>
<area shape="rect" id="node3" href="rc4_lib_8c.html#a13e5254ff57f1390856238cb4c4d71bb" title="rc4GetByte &#45; Function used to generate a single byte of the RC4 key stream for the RC4 context passed..." alt="" coords="227,5,315,32"/>
<area shape="rect" id="node4" href="rc4_lib_8c.html#abb929ea4bb5c1b41eaa7f3d067700c38" title="swapStateElements &#45; Function to swap the contents of the uint8_t pointers passed in as parameters ..." alt="" coords="363,5,501,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_aed0dce0633aa439d9479beab9822c6b8_icgraph.png" border="0" usemap="#rsa_8h_aed0dce0633aa439d9479beab9822c6b8_icgraph" alt=""/></div>
<map name="rsa_8h_aed0dce0633aa439d9479beab9822c6b8_icgraph" id="rsa_8h_aed0dce0633aa439d9479beab9822c6b8_icgraph">
<area shape="rect" id="node2" href="rsa_8h.html#ac2eb184f89ce2e058ce11f75d2babdd4" title="generateRsaKeys &#45; Function used to generate the RSA public and private key&#45;pair according to the spec..." alt="" coords="128,5,255,32"/>
<area shape="rect" id="node3" href="rsakeygen_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="303,5,353,32"/>
</map>
</div>

</div>
</div>
<a id="a89855ab18349364b596e545d789ba03d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89855ab18349364b596e545d789ba03d">&#9670;&nbsp;</a></span>rsaClean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsaClean </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrsactx__t.html">rsactx_t</a> *&#160;</td>
          <td class="paramname"><em>rsaCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rsaClean - Function used to deallocate all memory allocated for the RSA context state structure in </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rsaCtx.</td><td>In addition deallocates all memory used for the random number generator. </td></tr>
    <tr><td class="paramname">rsaCtx</td><td>- rsactx_t* - The RSA context state to deallocate. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00382">382</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a89855ab18349364b596e545d789ba03d_cgraph.png" border="0" usemap="#rsa_8h_a89855ab18349364b596e545d789ba03d_cgraph" alt=""/></div>
<map name="rsa_8h_a89855ab18349364b596e545d789ba03d_cgraph" id="rsa_8h_a89855ab18349364b596e545d789ba03d_cgraph">
<area shape="rect" id="node2" href="random_number_generator_8c.html#af6cd3a9729eb08f182d0b2df8bd8c7d8" title="destroyRNG &#45; Function used to deallocate all memory allocated for the random number generator..." alt="" coords="128,5,223,32"/>
<area shape="rect" id="node3" href="rc4_lib_8c.html#aaead699517d29af2819f4dd9ea36cd2d" title="destroyRc4Context &#45; Function used to deallocate all memory allocated for the rc4 context structure pa..." alt="" coords="271,5,405,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a89855ab18349364b596e545d789ba03d_icgraph.png" border="0" usemap="#rsa_8h_a89855ab18349364b596e545d789ba03d_icgraph" alt=""/></div>
<map name="rsa_8h_a89855ab18349364b596e545d789ba03d_icgraph" id="rsa_8h_a89855ab18349364b596e545d789ba03d_icgraph">
<area shape="rect" id="node2" href="rsakeygen_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="128,5,179,32"/>
</map>
</div>

</div>
</div>
<a id="a7195163cfaccb994f5b3f28655d6e280"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7195163cfaccb994f5b3f28655d6e280">&#9670;&nbsp;</a></span>rsaDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsaDecrypt </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>outputFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>privateKeyFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>cipherText</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rsaDecrypt - Function used to decrypt the ciphertext passed in as </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipherText</td><td>using RSA decryption and write the resulting plaintext to the file </td></tr>
    <tr><td class="paramname">outputFile</td><td>as a string using ascii plaintext encoding. Function treats the entire cipherText as the a single decimal value and performs the RSA decryption. The function reads in the private key and writes the result to the output file.</td></tr>
    <tr><td class="paramname">outputFile</td><td>- unsigned char* - File to write the plaintext to. </td></tr>
    <tr><td class="paramname">privateKeyFile</td><td>- unsigned char* - The file containing the private key to use during RSA decryption. The "n" paramter should be on the first line, followed by the newline character thereafter the "d" paramter should be placed in the private key file. </td></tr>
    <tr><td class="paramname">cipherText</td><td>- unsigned char* - The ciphertext to decrypt. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00256">256</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a7195163cfaccb994f5b3f28655d6e280_icgraph.png" border="0" usemap="#rsa_8h_a7195163cfaccb994f5b3f28655d6e280_icgraph" alt=""/></div>
<map name="rsa_8h_a7195163cfaccb994f5b3f28655d6e280_icgraph" id="rsa_8h_a7195163cfaccb994f5b3f28655d6e280_icgraph">
<area shape="rect" id="node2" href="rsadecrypt_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="140,5,191,32"/>
</map>
</div>

</div>
</div>
<a id="a94acde740fd5f6523c71d9310074e1ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94acde740fd5f6523c71d9310074e1ca">&#9670;&nbsp;</a></span>rsaEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsaEncrypt </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>outputFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>publicKeyFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>plainText</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>isPlaintextHex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rsaEncrypt - Function used to encrypt the plaintext passed in as </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plainText</td><td>using RSA encryption and write the resulting ciphertext to the file </td></tr>
    <tr><td class="paramname">outputFile</td><td>in decimal. Function treats the entire plainText as the a single decimal value and performs the RSA encryption. The function reads in the public key and writes the result to the output file.</td></tr>
    <tr><td class="paramname">outputFile</td><td>- unsigned char* - File to write the ciphertext to. </td></tr>
    <tr><td class="paramname">publicKeyFile</td><td>- unsigned char* - The file containing the public key to use during RSA encryption. The "n" paramter should be on the first line, followed by the newline character thereafter the "e" paramter should be placed in the public key file. </td></tr>
    <tr><td class="paramname">plainText</td><td>- unsigned char* - The plaintext to encrypt. </td></tr>
    <tr><td class="paramname">isPlaintextHex</td><td>- size_t - a flag used to indicate if the plaintext is encoded using ascii or hex encoding. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00175">175</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a94acde740fd5f6523c71d9310074e1ca_icgraph.png" border="0" usemap="#rsa_8h_a94acde740fd5f6523c71d9310074e1ca_icgraph" alt=""/></div>
<map name="rsa_8h_a94acde740fd5f6523c71d9310074e1ca_icgraph" id="rsa_8h_a94acde740fd5f6523c71d9310074e1ca_icgraph">
<area shape="rect" id="node2" href="rsaencrypt_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="139,5,189,32"/>
</map>
</div>

</div>
</div>
<a id="a41e602bedc2bfcd50c6e35bfb6279ab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41e602bedc2bfcd50c6e35bfb6279ab5">&#9670;&nbsp;</a></span>rsaInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsaInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrsactx__t.html">rsactx_t</a> *&#160;</td>
          <td class="paramname"><em>rsaCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rsaInit - Function used to initialize the RSA context state structure passed in as </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rsaCtx.</td><td>Used as a helper function for the constructRSAContext function. Does not need to be explicitly called by the user. Initializes all mpz library variables used as required.</td></tr>
    <tr><td class="paramname">rsaCtx</td><td>- rsactx_t* - A pointer to the RSA context state structure to initialize. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00054">54</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a41e602bedc2bfcd50c6e35bfb6279ab5_icgraph.png" border="0" usemap="#rsa_8h_a41e602bedc2bfcd50c6e35bfb6279ab5_icgraph" alt=""/></div>
<map name="rsa_8h_a41e602bedc2bfcd50c6e35bfb6279ab5_icgraph" id="rsa_8h_a41e602bedc2bfcd50c6e35bfb6279ab5_icgraph">
<area shape="rect" id="node2" href="rsa_8h.html#a32b449824145177f99b25444768d5d3d" title="constructRSAContext &#45; Function used to construct the RSA context structure used for RSA key&#45;pair gene..." alt="" coords="112,5,263,32"/>
<area shape="rect" id="node3" href="rsakeygen_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="311,5,361,32"/>
</map>
</div>

</div>
</div>
<a id="a00fa4aa44618d82f5ef6ec9523cbc165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00fa4aa44618d82f5ef6ec9523cbc165">&#9670;&nbsp;</a></span>rsaWriteKeysToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsaWriteKeysToFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrsactx__t.html">rsactx_t</a> *&#160;</td>
          <td class="paramname"><em>rsaCtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>publicKeyFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>privateKeyFileName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>rsaWriteKeysToFile - Function used to write the public and private keys store in the RSA Context passed in as </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rsaCtx,to</td><td>the </td></tr>
    <tr><td class="paramname">publicKeyFileName</td><td>and </td></tr>
    <tr><td class="paramname">privateKeyFileName</td><td>respectively. The RSA private and public keys are written to the files in accordance with the practical specification. With the n paramter followed by a newline character, followed by d/e and finally a newline character.</td></tr>
    <tr><td class="paramname">rsaCtx</td><td>- rsactx_t* - The RSA context containing the public and private key pair to be written. </td></tr>
    <tr><td class="paramname">publicKeyFileName</td><td>- unsigned char* - The file to write the RSA public key to. </td></tr>
    <tr><td class="paramname">privateKeyFileName</td><td>- unsigned char* - The file to write the RSA private key to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rsa_8c_source.html#l00345">345</a> of file <a class="el" href="rsa_8c_source.html">rsa.c</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="rsa_8h_a00fa4aa44618d82f5ef6ec9523cbc165_icgraph.png" border="0" usemap="#rsa_8h_a00fa4aa44618d82f5ef6ec9523cbc165_icgraph" alt=""/></div>
<map name="rsa_8h_a00fa4aa44618d82f5ef6ec9523cbc165_icgraph" id="rsa_8h_a00fa4aa44618d82f5ef6ec9523cbc165_icgraph">
<area shape="rect" id="node2" href="rsakeygen_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="191,5,241,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
